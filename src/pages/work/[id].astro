---
import WorkHeader from "@components/work/WorkHeader.astro";
import Layout from "@layouts/Layout.astro";
import { Picture } from "astro:assets";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const works = await getCollection("work");
  return works.map((work) => ({
    params: { id: work.id },
    props: { work },
  }));
}

const { work } = Astro.props;
const { Content } = await render(work);
const publishedDate = new Date(work.data.date);
---

<Layout
  page={work.data.title}
  description={work.data.description}
  {publishedDate}
  image={work.data.img_social || work.data.img}
>
  <main class="container flex flex-col gap-8 py-8 lg:gap-12 lg:py-24">
    <WorkHeader data={work.data} />
    <Picture
      src={work.data.img}
      formats={["avif", "webp"]}
      sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 1600px) 720px, ${work.data.img.width}px`}
      alt={`${work.data.title} project`}
    />
    <section
      class="prose sm:prose-lg lg:prose-xl prose-stone dark:prose-invert prose-img:shadow-xl prose-a:border-b prose-a:border-dashed prose-a:no-underline prose-a:hover:border-solid mt-8 md:mx-auto"
    >
      <Content />
    </section>
  </main>
</Layout>
